<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BvR - Bleu vs Rouge</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéÆ</text></svg>">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .user-section {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 25px;
            backdrop-filter: blur(10px);
        }
        .user-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
        .user-name {
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        .user-stats {
            color: #aaa;
            font-size: 12px;
        }
        .btn-logout {
            background: rgba(220, 53, 69, 0.8);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 12px;
        }
        .btn-logout:hover {
            background: rgba(220, 53, 69, 1);
        }
        .auth-buttons {
            display: flex;
            gap: 10px;
        }
        .btn-login, .btn-register {
            padding: 10px 20px;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
        }
        .btn-login {
            background: rgba(255,255,255,0.2);
            color: white;
        }
        .btn-register {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .btn-login:hover {
            background: rgba(255,255,255,0.3);
        }
        .btn-register:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <!-- Section utilisateur (haut droite) -->
    <div class="user-section" id="userSection">
        <!-- Contenu dynamique ajout√© par JavaScript -->
    </div>

    <!-- Particules d'arri√®re-plan anim√©es -->
    <div class="particles" id="particles"></div>

    <!-- √âcran d'accueil -->
    <div id="screen-welcome" class="screen active">
        <div class="container">
            <div class="logo-container">
                <h1 class="game-title">
                    <span class="blue-text">BLEU</span>
                    <span class="vs">VS</span>
                    <span class="red-text">ROUGE</span>
                </h1>
                <p class="tagline">Infiltration ‚Ä¢ D√©duction ‚Ä¢ √âlimination</p>
            </div>

            <div class="menu-buttons">
                <button class="btn btn-primary" onclick="showCreateGame()">
                    <span class="btn-icon">üéÆ</span>
                    Cr√©er une partie
                </button>
                <button class="btn btn-secondary" onclick="showJoinGame()">
                    <span class="btn-icon">üîó</span>
                    Rejoindre une partie
                </button>
            </div>

            <div class="info-box">
                <div class="info-item">
                    <span class="info-icon">üë•</span>
                    <span>4+ joueurs</span>
                </div>
                <div class="info-item">
                    <span class="info-icon">‚è±Ô∏è</span>
                    <span>60 minutes</span>
                </div>
                <div class="info-item">
                    <span class="info-icon">üéØ</span>
                    <span>Strat√©gie</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Les autres √©crans restent identiques... -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="app.js"></script>
    <script>
        // Gestion de l'authentification c√¥t√© client
        const API_URL = window.location.origin;
        let currentUser = null;

        // V√©rifier si l'utilisateur est connect√© au chargement de la page
        window.addEventListener('DOMContentLoaded', () => {
            checkAuthStatus();
        });

        function checkAuthStatus() {
            const token = localStorage.getItem('token');
            const userStr = localStorage.getItem('user');
            
            if (token && userStr) {
                currentUser = JSON.parse(userStr);
                displayUserInfo();
            } else {
                displayAuthButtons();
            }
        }

        function displayUserInfo() {
            const userSection = document.getElementById('userSection');
            userSection.innerHTML = `
                <div class="user-info">
                    <div class="user-name">üë§ ${currentUser.username}</div>
                    <div class="user-stats">üéÆ ${currentUser.gamesPlayed} parties ‚Ä¢ üèÜ ${currentUser.gamesWon} victoires</div>
                </div>
                <button class="btn-logout" onclick="logout()">D√©connexion</button>
            `;
        }

        function displayAuthButtons() {
            const userSection = document.getElementById('userSection');
            userSection.innerHTML = `
                <div class="auth-buttons">
                    <button class="btn-login" onclick="window.location.href='login.html'">Connexion</button>
                    <button class="btn-register" onclick="window.location.href='register.html'">Inscription</button>
                </div>
            `;
        }

        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            currentUser = null;
            displayAuthButtons();
            alert('Vous avez √©t√© d√©connect√©');
        }

        // Modifier la fonction createGame originale pour inclure l'userId
        const originalCreateGame = window.createGame;
        if (originalCreateGame) {
            window.createGame = function() {
                const pseudo = document.getElementById('create-pseudo').value.trim();
                const realLifeInfo = document.getElementById('create-real-info').value.trim();

                if (!pseudo || !realLifeInfo) {
                    alert('Merci de renseigner tous les champs.');
                    return;
                }

                // Envoyer avec userId si connect√©
                socket.emit('create_game', {
                    pseudo: pseudo,
                    realLifeInfo: realLifeInfo,
                    userId: currentUser ? currentUser.id : null
                });
            };
        }
    </script>
</body>
</html>
